<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Science Statistical Metrics Analyser</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Add Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
        /* CSS Variables for Theming */
		:root {
			--primary-color: #007BFF;
			--background-color: #f8f9fa;
			--text-color: #333;
			--container-bg-color: #fff;
			--input-bg-color: #e9ecef;
			--tooltip-bg-color: #555;
			--dark-mode-bg-color: #333;
			--dark-mode-text-color: #fff;
			--dark-mode-container-bg-color: #444;
			--dark-mode-input-bg-color: #555;
			--dark-mode-result-bg-color: #666;
			--label-color: #555;
		}

		/* Base Body Styles */
		body {
			font-family: 'Roboto', sans-serif;
			background-color: var(--background-color);
			color: var(--text-color);
			margin: 0;
			padding: 0;
			display: flex;
			justify-content: center;
			align-items: flex-start;
			min-height: 100vh;
			transition: background-color 0.3s, color 0.3s;
			font-size: 1rem; /* Base font size */
		}

		/* Main Container */
		main {
			background-color: var(--container-bg-color);
			padding: 20px;
			border-radius: 8px;
			box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
			max-width: 900px;
			width: 100%;
			margin: 80px auto 40px auto;
		}

		/* Header Styles */
		h1 {
			text-align: center;
			color: var(--primary-color);
			margin: 0;
			font-size: 1.75rem;
			animation: fadeInDown 1s ease-out;
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			background-color: var(--container-bg-color);
			padding: 20px 0;
			box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
			z-index: 1000;
		}
		
		h3 {
			font-size: 1.3rem;
			color: var(--primary-color);
			margin-bottom: 15px;
			text-align: left;
			animation: fadeInDown 1s ease-out;
		}

		/* Responsive Media Queries */
		@media (max-width: 768px) {
			main {
				padding: 15px;
				margin-top: 100px;
			}
			h1 {
				font-size: 1.5rem;
			}
			.metric-group {
				grid-template-columns: 1fr;
			}
		}

		@media (max-width: 480px) {
			main {
				padding: 10px;
				margin-top: 80px;
			}
			h1 {
				font-size: 1.25rem;
				padding: 15px 0;
			}
		}

		/* Input Section Styles */
		.input-section {
			background-color: var(--input-bg-color);
			padding: 20px;
			border-radius: 8px;
			margin-bottom: 20px;
			display: flex;
			flex-wrap: wrap;
			justify-content: space-between;
			animation: fadeInUp 1s ease-out;
		}

		.input-container {
			flex: 1;
			display: flex;
			flex-direction: column;
			justify-content: space-between;
			margin-right: 10px;
		}

		.input-container:last-child {
			margin-right: 0;
		}

		.input-section__item {
			display: flex;
			align-items: center;
			margin-bottom: 20px;
		}

		/* Label Styles */
		label {
			font-weight: 500;
			margin-right: 10px;
			color: var(--label-color);
			white-space: nowrap;
			flex-shrink: 0;
		}

		/* Input Styles */
		input[type="number"] {
			width: 80px;
			padding: 8px;
			border-radius: 5px;
			border: 1px solid #ced4da;
			transition: border-color 0.3s;
			margin-left: 10px;
			box-sizing: border-box;
		}

		input[type="range"] {
			flex: 1;
			margin-right: 10px;
		}

		input[type="number"]:focus, input[type="range"]:focus {
			border-color: var(--primary-color);
			outline: none;
			box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
		}

		input[type="range"]::-webkit-slider-thumb {
			width: 15px;
			height: 15px;
			background: var(--primary-color);
			cursor: pointer;
			border-radius: 50%;
		}

		.confusion-matrix-totals {
			display: flex;
			justify-content: space-between;
			gap: 20px; /* Space between the two sections */
			margin-bottom: 20px; /* Adjust margin as needed */
		}

		.confusion-matrix-totals > section {
			flex: 1;
			min-width: 44%; /* Ensure both sections have a balanced width */
			max-width: 44%; /* Prevent sections from becoming too wide */
		}
		
		.confusion-matrix {
			background-color: var(--input-bg-color);
			padding: 20px;
			border-radius: 8px;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			animation: fadeInUp 1s ease-out;
		}

		.confusion-matrix__table {
			width: 100%;
			border-collapse: collapse;
			text-align: center;
		}

		.confusion-matrix__table th, .confusion-matrix__table td {
			border: 1px solid #ced4da;
			padding: 10px;
		}

		.confusion-matrix__table th {
			background-color: var(--input-bg-color);
			color: var(--text-color);
			font-weight: 500;
		}

		.confusion-matrix__table td {
			background-color: var(--container-bg-color);
			font-weight: bold;
			color: var(--text-color);
		}

		/* True Positive/Negative Cell Colors */
		.confusion-matrix__table td#tp-cell,
		.confusion-matrix__table td#tn-cell {
			background-color: rgba(75, 192, 192, 0.2);
			color: #3c763d;
		}

		/* False Positive/Negative Cell Colors */
		.confusion-matrix__table td#fp-cell,
		.confusion-matrix__table td#fn-cell {
			background-color: rgba(255, 99, 132, 0.2);
			color: #a94442;
		}

		/* Total Metrics Display */	
		.total-metrics {
			background-color: var(--input-bg-color);
			padding: 20px;
			border-radius: 8px;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			display: flex;
			justify-content: space-between;
			gap: 20px;
			animation: fadeInUp 1s ease-out;
		}

		.total-pos-neg, 
		.toal-samples-balance {
			display: flex;
			flex-direction: column;
			justify-content: center;
			align-items: center;
			gap: 30px;
			flex: 1;
		}

		.total-metrics__item {
			text-align: center;
			margin-bottom: 10px;
		}

		.total-metrics__item label {
			font-weight: 700;
			color: var(--label-color);
			display: block;
			margin-bottom: 5px;
			font-size: 1rem; /* Adjust font size for better readability */
		}

		.total-metrics__item span {
			display: block;
			font-size: 1.5rem; /* Increase font size for emphasis */
			font-weight: 500;
		}

		/* Balance Bar Styles */
		.balance-container {
			width: 100%;
			display: flex;
			flex-direction: column;
			align-items: center;
		}

		.balance-bar {
			position: relative;
			width: 80%;
			height: 8px;
			background-color: #ccc;
			border-radius: 4px;
			margin: 10px auto;
		}

		.balance-marker {
			position: absolute;
			width: 16px;
			height: 16px;
			background-color: #007BFF;
			border-radius: 50%;
			top: -4px;
			left: 50%;
			transform: translateX(-50%);
			transition: left 0.3s ease;
		}

		.ideal-marker {
			position: absolute;
			width: 2px;
			height: 16px;
			background-color: #FF6347;
			top: -4px;
			left: 50%;
			transform: translateX(-50%);
		}
		
		.metrics-and-chart {
			display: flex;
			gap: 20px; /* Increased space between metrics and chart for better separation */
			flex-wrap: wrap; /* Allows elements to wrap on smaller screens */
			justify-content: space-between;
		}

		.metrics-and-chart > section {
			flex: 1;
			min-width: 45%; /* Ensure both sections have a balanced width */
			max-width: 45%; /* Prevent sections from becoming too wide */
		}

		/* Result Section Styles */
		.result {
			margin-top: 10px;
			padding: 15px;
			background-color: var(--input-bg-color);
			border-radius: 8px;
			color: var(--text-color);
			animation: fadeIn 1s ease-out;
		}

		/* Metric Group Styling */
		.metric-group {
			display: grid;
			grid-template-columns: repeat(2, 1fr);
			gap: 20px;
			width: 100%;
			box-sizing: border-box;
		}

		.metric-group__item {
			display: flex;
			justify-content: space-between;
			align-items: center;
			padding: 15px;
			border-radius: 5px;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			background: transparent;
			animation: fadeIn 1s ease-out;
		}

		.metric-group__label {
			display: flex;
			align-items: center;
			flex-basis: 50%;
		}

		.metric-group__label strong {
			margin-right: 5px;
			color: var(--label-color);
		}

		.metric-group__value {
			flex-basis: 50%;
			display: flex;
			justify-content: flex-end;
			font-size: 1.1rem;
			font-weight: 500;
			color: var(--label-color);
		}

		/* Metric Value Colors */
		.metric-value-green {
			background-color: rgba(75, 192, 192, 0.2);
			color: #3c763d;
			border-radius: 4px;
			padding: 5px;
		}

		.metric-value-amber {
			background-color: rgba(255, 206, 86, 0.2);
			color: #8a6d3b;
			border-radius: 4px;
			padding: 5px;
		}

		.metric-value-red {
			background-color: rgba(255, 99, 132, 0.2);
			color: #a94442;
			border-radius: 4px;
			padding: 5px;
		}

		/* Tooltip Styles */
		.tooltip {
			position: relative;
			cursor: pointer;
			margin-left: 5px;
			display: inline-block;
		}

		.tooltip .tooltip-icon {
			font-size: 1.2rem;
			color: #007BFF;
			vertical-align: middle;
		}

		.tooltip .tooltiptext {
			visibility: hidden;
			width: 250px;
			background-color: #333;
			color: #fff;
			text-align: left;
			border-radius: 8px;
			padding: 10px;
			box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
			position: absolute;
			z-index: 1;
			bottom: 120%;
			left: 50%;
			transform: translateX(-50%);
			opacity: 0;
			transition: opacity 0.3s ease-in-out;
			font-size: 0.9rem;
		}

		.tooltip .tooltiptext::after {
			content: "";
			position: absolute;
			top: 100%;
			left: 50%;
			margin-left: -5px;
			border-width: 5px;
			border-style: solid;
			border-color: #333 transparent transparent transparent;
		}

		.tooltip:hover .tooltiptext {
			visibility: visible;
			opacity: 1;
		}

		/* Chart Container Styles */
		.chart-container {
			display: flex;
			justify-content: center;
			align-items: center;
			background-color: #e9ecef;
			padding: 20px;
			border-radius: 8px;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			margin-top: 10px;
		}

		.chart {
			height: 100px;
			width: 100%;
			animation: fadeInUp 1s ease-out;
		}
		
		.chart-container canvas {
			width: 100%;
			height: auto;
		}

		/* Insights Panel Styling */
		.insights-panel {
			background-color: var(--input-bg-color);
			padding: 20px;
			border-radius: 8px;
			margin-top: 20px;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			color: var(--text-color);
			animation: fadeInUp 1s ease-out;
		}

		.insights-panel h2 {
			margin-bottom: 10px;
			font-size: 1.5rem;
			color: var(--primary-color);
		}

		.insight {
			margin-bottom: 10px;
			font-size: 1rem;
			color: var(--text-color);
			display: flex;
			align-items: center;
			animation: fadeIn 0.8s ease-out;
		}

		.insight-icon {
			margin-right: 8px;
			font-size: 1.2rem;
		}

		/* Dark Mode Toggle */
		#dark-mode-toggle {
			position: fixed;
			right: 20px;
			top: 10px;
			width: 50px;
			height: 30px;
			background-color: #ccc;
			border-radius: 15px;
			cursor: pointer;
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: 0 5px;
			box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
			z-index: 1001;
		}

		#dark-mode-toggle .icon {
			font-size: 1.2rem;
			transition: opacity 0.3s ease;
			z-index: 1;
		}

		.light-mode-icon {
			color: #FFD700;
		}

		.dark-mode-icon {
			color: #4C4C4C;
			opacity: 0;
		}

		#dark-mode-toggle.active .light-mode-icon {
			opacity: 0;
		}

		#dark-mode-toggle.active .dark-mode-icon {
			opacity: 1;
		}

		#dark-mode-toggle .slider {
			width: 25px;
			height: 25px;
			background-color: white;
			border-radius: 50%;
			position: absolute;
			left: 5px;
			transition: transform 0.3s ease;
			z-index: 0;
		}

		#dark-mode-toggle.active .slider {
			transform: translateX(25px);
		}
		
		#dark-mode-toggle:focus, .tooltip:focus {
			outline: 2px solid var(--primary-color);
			outline-offset: 4px;
		}

		/* Dark Mode Styles */
		.dark-mode {
			background-color: var(--dark-mode-bg-color);
			color: var(--dark-mode-text-color);
			transition: background-color 0.3s, color 0.3s;
		}

		.dark-mode main {
			background-color: var(--dark-mode-container-bg-color);
		}

		.dark-mode h1 {
			background-color: var(--dark-mode-container-bg-color);
			color: var(--dark-mode-text-color);
			transition: background-color 0.3s, color 0.3s;
		}
		
		.dark-mode h3 {
			background-color: var(--dark-mode-container-bg-color);
			color: var(--dark-mode-text-color);
			transition: background-color 0.3s, color 0.3s;
		}

		.dark-mode .input-section {
			background-color: var(--dark-mode-input-bg-color);
			color: var(--dark-mode-text-color);
		}

		.dark-mode .confusion-matrix__table th,
		.dark-mode .confusion-matrix__table td {
			border-color: #888;
		}

		.dark-mode .confusion-matrix__table td#tp-cell,
		.dark-mode .confusion-matrix__table td#tn-cell {
			background-color: rgba(75, 192, 192, 0.2);
			color: #66FF66;
		}

		.dark-mode .confusion-matrix__table td#fp-cell,
		.dark-mode .confusion-matrix__table td#fn-cell {
			background-color: rgba(255, 99, 132, 0.2);
			color: #FF6666;
		}

		.dark-mode .confusion-matrix__table th {
			background-color: var(--dark-mode-input-bg-color);
			color: #fff;
		}

		.dark-mode .confusion-matrix {
			background-color: var(--dark-mode-input-bg-color);
		}

		.dark-mode .total-metrics {
			background-color: var(--dark-mode-input-bg-color);
			color: var(--dark-mode-text-color);
		}

		/* Update text color for labels in Total Metrics section in dark mode */
		.dark-mode .total-metrics__item label {
			color: var(--dark-mode-text-color);
		}

		.dark-mode .total-metrics__item span {
			color: var(--dark-mode-text-color);
		}

		.dark-mode .result {
			background-color: var(--dark-mode-input-bg-color);
			color: var(--dark-mode-text-color);
		}

		.dark-mode .metric-group__label strong,
		.dark-mode .metric-group__value {
			color: var(--dark-mode-text-color);
		}

		.dark-mode .metric-group__value {
			background-color: rgba(255, 255, 255, 0.1);
		}

		.dark-mode .metric-value-green {
			background-color: rgba(0, 128, 0, 0.2);
			color: #66FF66;
		}

		.dark-mode .metric-value-amber {
			background-color: rgba(255, 165, 0, 0.2);
			color: #FFD700;
		}

		.dark-mode .metric-value-red {
			background-color: rgba(139, 0, 0, 0.2);
			color: #FF6666;
		}

		.dark-mode .tooltip {
			color: var(--primary-color);
		}

		.dark-mode .tooltip .tooltiptext {
			background-color: var(--dark-mode-input-bg-color);
			color: var(--dark-mode-text-color);
			border: 1px solid #888;
		}

		.dark-mode .tooltip:hover .tooltiptext {
			background-color: var(--dark-mode-result-bg-color);
			opacity: 1;
		}

		.dark-mode .tooltip .tooltiptext p {
			margin: 0;
			padding: 0;
			font-size: 0.9rem;
			line-height: 1.2;
			color: var(--dark-mode-text-color);
		}

		.dark-mode .input-section__item label {
			color: var(--dark-mode-text-color);
		}

		.dark-mode input[type="number"], 
		.dark-mode input[type="range"] {
			background-color: var(--dark-mode-input-bg-color);
			color: var(--dark-mode-text-color);
			border-color: #888;
		}

		.dark-mode input[type="number"]::placeholder {
			color: var(--dark-mode-text-color);
		}

		.dark-mode .chart-container {
			background-color: var(--dark-mode-input-bg-color);
			border-radius: 8px;
			padding: 20px;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
		}

		.dark-mode .insights-panel {
			background-color: var(--dark-mode-input-bg-color);
			color: var(--dark-mode-text-color);
		}

		.dark-mode .insights-panel h2 {
			color: var(--primary-color);
		}

		.dark-mode .insight {
			color: var(--dark-mode-text-color);
		}

		.dark-mode .insight-icon {
			color: var(--dark-mode-text-color);
		}

		/* Keyframe Animations */
		@keyframes fadeInDown {
			0% {
				opacity: 0;
				transform: translateY(-20px);
			}
			100% {
				opacity: 1;
				transform: translateY(0);
			}
		}

		@keyframes fadeInUp {
			0% {
				opacity: 0;
				transform: translateY(20px);
			}
			100% {
				opacity: 1;
				transform: translateY(0);
			}
		}

		@keyframes fadeIn {
			0% {
				opacity: 0;
			}
			100% {
				opacity: 1;
			}
		}
    </style>
</head>
<body>
    <div id="dark-mode-toggle">
        <span class="icon light-mode-icon"><i class="fas fa-sun"></i></span>
        <span class="icon dark-mode-icon"><i class="fas fa-moon"></i></span>
        <div class="slider"></div>
    </div>
    <main>
        <h1>Data Science Statistical Metrics Analyser</h1>
		<h3>Input Parameters</h3>
        <section class="input-section">
            <div class="input-container">
                <div class="input-section__item">
                    <label for="tp">True Positives (TP):</label>
                    <input type="range" id="tp-range" min="0" max="100" value="10" oninput="syncInput('tp-range', 'tp'); calculateMetrics();">
                    <input type="number" id="tp" value="10" min="0" oninput="syncRange('tp', 'tp-range'); calculateMetrics();" onkeydown="return preventInvalidInput(event);" aria-labelledby="tp-label">
                </div>

                <div class="input-section__item">
                    <label for="fp">False Positives (FP):</label>
                    <input type="range" id="fp-range" min="0" max="100" value="5" oninput="syncInput('fp-range', 'fp'); calculateMetrics();">
                    <input type="number" id="fp" value="5" min="0" oninput="syncRange('fp', 'fp-range'); calculateMetrics();" onkeydown="return preventInvalidInput(event);" aria-labelledby="fp-label">
                </div>                
            </div>

            <div class="input-container">
                <div class="input-section__item">
                    <label for="fn">False Negatives (FN):</label>
                    <input type="range" id="fn-range" min="0" max="100" value="5" oninput="syncInput('fn-range', 'fn'); calculateMetrics();">
                    <input type="number" id="fn" value="5" min="0" oninput="syncRange('fn', 'fn-range'); calculateMetrics();" onkeydown="return preventInvalidInput(event);" aria-labelledby="fn-label">
                </div>

                <div class="input-section__item">
                    <label for="tn">True Negatives (TN):</label>
                    <input type="range" id="tn-range" min="0" max="100" value="10" oninput="syncInput('tn-range', 'tn'); calculateMetrics();">
                    <input type="number" id="tn" value="10" min="0" oninput="syncRange('tn', 'tn-range'); calculateMetrics();" onkeydown="return preventInvalidInput(event);" aria-labelledby="tn-label">
                </div>
            </div>
        </section>
		
		<div class="confusion-matrix-totals">
			<section class="confusion-matrix">
				<table id="confusionMatrix" class="confusion-matrix__table">
					<thead>
						<tr>
							<th>Confusion Matrix</th>
							<th>Predicted Positive</th>
							<th>Predicted Negative</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<th>Actual Positive</th>
							<td id="tp-cell">TP</td>
							<td id="fn-cell">FN</td>
						</tr>
						<tr>
							<th>Actual Negative</th>
							<td id="fp-cell">FP</td>
							<td id="tn-cell">TN</td>
						</tr>
					</tbody>
				</table>
			</section>

			<section class="total-metrics">
				<div class="total-pos-neg">
					<div class="total-metrics__item">
						<label>Total Positives</label>
						<span id="totalPositives">15</span>
					</div>
					<div class="total-metrics__item">
						<label>Total Negatives</label>
						<span id="totalNegatives">15</span>
					</div>
				</div>
				<div class="toal-samples-balance">
					<div class="total-metrics__item">
						<label>Total Samples</label>
						<span id="totalSamples">30</span>
					</div>
					<div class="total-metrics__item balance-container">
						<label>Samples Distribution</label>
						<div class="balance-bar">
							<div class="balance-marker" id="balanceMarker"></div>
							<div class="ideal-marker" id="idealMarker"></div>
						</div>
					</div>
				</div>
			</section>
		</div>

		<h3>Metrics</h3>
		<div class="metrics-and-chart">
			<section class="result" id="result" aria-live="polite">
				<div class="metric-group">
					<div class="metric-group__item">
						<div class="metric-group__label">
							<strong>F1</strong>
							<span class="tooltip">
								<i class="fas fa-info-circle tooltip-icon"></i>
								<span class="tooltiptext">
									<h4>F1 Score</h4>
									<p>The F1 Score is the harmonic mean of Precision and Recall.</p>
									<ul>
										<li>Formula: 2 * (Precision * Recall) / (Precision + Recall)</li>
										<li>Balanced score between precision and recall.</li>
									</ul>
								</span>
							</span>
						</div>
						<div class="metric-group__value" id="f1-result">0.67</div>
					</div>
					<div class="metric-group__item">
						<div class="metric-group__label">
							<strong>Accuracy</strong>
							<span class="tooltip">
								<i class="fas fa-info-circle tooltip-icon"></i>
								<span class="tooltiptext">
									<h4>Accuracy</h4>
									<p>Overall correctness of predictions.</p>
									<ul>
										<li>Formula: (TP + TN) / (TP + TN + FP + FN)</li>
										<li>High accuracy indicates a good model.</li>
									</ul>
								</span>
							</span>
						</div>
						<div class="metric-group__value" id="accuracy-result">0.67</div>
					</div>
				</div>
				<div class="metric-group">
					<div class="metric-group__item">
						<div class="metric-group__label">
							<strong>Precision</strong>
							<span class="tooltip">
								<i class="fas fa-info-circle tooltip-icon"></i>
								<span class="tooltiptext">
									<h4>Precision</h4>
									<p>Reliability of positive predictions.</p>
									<ul>
										<li>Formula: TP / (TP + FP)</li>
										<li>High precision indicates few false positives.</li>
									</ul>
								</span>
							</span>
						</div>
						<div class="metric-group__value" id="precision-result">0.67</div>
					</div>
					<div class="metric-group__item">
						<div class="metric-group__label">
							<strong>NPV</strong>
							<span class="tooltip">
								<i class="fas fa-info-circle tooltip-icon"></i>
								<span class="tooltiptext">
									<h4>Negative Predictive Value (NPV)</h4>
									<p>Reliability of negative predictions.</p>
									<ul>
										<li>Formula: TN / (TN + FN)</li>
										<li>High NPV indicates few false negatives.</li>
									</ul>
								</span>
							</span>
						</div>
						<div class="metric-group__value" id="npv-result">0.67</div>
					</div>
				</div>
				<div class="metric-group">
					<div class="metric-group__item">
						<div class="metric-group__label">
							<strong>Recall</strong>
							<span class="tooltip">
								<i class="fas fa-info-circle tooltip-icon"></i>
								<span class="tooltiptext">
									<h4>Recall</h4>
									<p>Ability to find all positive instances.</p>
									<ul>
										<li>Formula: TP / (TP + FN)</li>
										<li>High recall indicates few false negatives.</li>
									</ul>
								</span>
							</span>
						</div>
						<div class="metric-group__value" id="recall-result">0.67</div>
					</div>
					<div class="metric-group__item">
						<div class="metric-group__label">
							<strong>Specificity</strong>
							<span class="tooltip">
								<i class="fas fa-info-circle tooltip-icon"></i>
								<span class="tooltiptext">
									<h4>Specificity</h4>
									<p>Ability to find all negative instances.</p>
									<ul>
										<li>Formula: TN / (TN + FP)</li>
										<li>High specificity indicates few false positives.</li>
									</ul>
								</span>
							</span>
						</div>
						<div class="metric-group__value" id="specificity-result">0.67</div>
					</div>
				</div>
			</section>
			
		<section class="chart-container">
            <canvas id="metricsChart" class="chart"></canvas>
        </section>
			
		</div>

        <h3>Insights</h3>
        <section class="insights-panel" id="insightsPanel">
            <div id="overallSummary"></div>
            <div id="recommendations"></div>
        </section>

    </main>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            initializeDarkModeToggle();
            calculateMetrics();
        });

        /* Synchronize input value with the corresponding range slider */
        function syncInput(rangeId, inputId) {
            document.getElementById(inputId).value = document.getElementById(rangeId).value;
        }

        /* Synchronize range slider value with the corresponding input */
        function syncRange(inputId, rangeId) {
            const value = document.getElementById(inputId).value;
            document.getElementById(rangeId).value = Math.max(value, 0);
        }

        /* Prevent invalid input characters in number fields */
        function preventInvalidInput(event) {
            return event.keyCode !== 69 && event.keyCode !== 189;
        }

        let myChart;

        /* Calculate and update all statistical metrics */
        function calculateMetrics() {
            const tp = parseFloat(document.getElementById('tp').value);
            const tn = parseFloat(document.getElementById('tn').value);
            const fp = parseFloat(document.getElementById('fp').value);
            const fn = parseFloat(document.getElementById('fn').value);

            const accuracy = (tp + tn) / (tp + tn + fp + fn);
            const precision = tp / (tp + fp);
            const recall = tp / (tp + fn);
            const specificity = tn / (tn + fp);
            const npv = tn / (tn + fn);
            const f1_score = 2 * (precision * recall) / (precision + recall);

            updateMetricResults({
                accuracy: accuracy.toFixed(2),
                precision: precision.toFixed(2),
                recall: recall.toFixed(2),
                specificity: specificity.toFixed(2),
                npv: npv.toFixed(2),
                f1_score: f1_score.toFixed(2)
            });

            const totalPositives = tp + fn;
            const totalNegatives = tn + fp;
            const totalSamples = totalPositives + totalNegatives;

            updateBalanceMarker();
            updateConfusionMatrix(tp, tn, fp, fn);

            document.getElementById('totalPositives').innerText = totalPositives;
            document.getElementById('totalNegatives').innerText = totalNegatives;
            document.getElementById('totalSamples').innerText = totalSamples;

            updateChart([accuracy, precision, recall, specificity, npv, f1_score]);
        }

        /* Update the position of the balance marker based on the data */
        function updateBalanceMarker() {
            const tp = parseFloat(document.getElementById('tp').value);
            const fn = parseFloat(document.getElementById('fn').value);
            const tn = parseFloat(document.getElementById('tn').value);
            const fp = parseFloat(document.getElementById('fp').value);

            const totalSamples = tp + fn + tn + fp;
            const positiveRatio = (tp + fn) / totalSamples;
            const markerPosition = positiveRatio * 100;

            const marker = document.querySelector('.balance-marker');
            marker.style.left = `${markerPosition}%`;
        }

        /* Update the values displayed in the confusion matrix */
        function updateConfusionMatrix(tp, tn, fp, fn) {
            document.getElementById('tp-cell').innerText = tp;
            document.getElementById('tn-cell').innerText = tn;
            document.getElementById('fp-cell').innerText = fp;
            document.getElementById('fn-cell').innerText = fn;
        }

        /* Generate and display insights based on the calculated metrics */
        function generateOverallSummary(metrics) {
            let summary = '';

            if (metrics.accuracy >= 0.9) {
                summary += 'Overall, your model is performing good with a high accuracy of ' + metrics.accuracy + '. ';
            } else if (metrics.accuracy >= 0.75) {
                summary += 'Your model has a moderate accuracy of ' + metrics.accuracy + ', but there is room for improvement. ';
            } else {
                summary += 'The model accuracy is relatively low at ' + metrics.accuracy + '. Consider revisiting the model and improving its performance. ';
            }

            if (metrics.f1_score >= 0.9) {
                summary += 'The F1 Score of ' + metrics.f1_score + ' is good, indicating a great balance between precision and recall. ';
            } else if (metrics.f1_score >= 0.75) {
                summary += 'The F1 Score is ' + metrics.f1_score + ', which is moderate and may indicate some trade-offs between precision and recall. ';
            } else {
                summary += 'The F1 Score is relatively low at ' + metrics.f1_score + '. You might want to improve either precision or recall for better performance. ';
            }

            return summary;
        }

		/* Generate recommendations based on calculated metrics */
		function generateRecommendations(metrics) {
			const recommendations = [];

			// Font Awesome icons with color styling
			const goodIcon = '<i class="fas fa-check-circle" style="color: #28a745; margin-right: 8px;"></i>'; // Green
			const moderateIcon = '<i class="fas fa-exclamation-triangle" style="color: #ffc107; margin-right: 8px;"></i>'; // Amber
			const badIcon = '<i class="fas fa-times-circle" style="color: #dc3545; margin-right: 8px;"></i>'; // Red

			if (metrics.accuracy >= 0.9) {
				recommendations.push(`${goodIcon} Accuracy is good. Maintain current methods.`);
			} else if (metrics.accuracy >= 0.75) {
				recommendations.push(`${moderateIcon} Accuracy is moderate. There's room for improvement.`);
			} else {
				recommendations.push(`${badIcon} Accuracy is low. Consider reviewing model features or increasing data quality.`);
			}

			if (metrics.precision >= 0.9) {
				recommendations.push(`${goodIcon} Precision is good, indicating reliable positive predictions.`);
			} else if (metrics.precision >= 0.75) {
				recommendations.push(`${moderateIcon} Precision is moderate. There may be some false positives.`);
			} else {
				recommendations.push(`${badIcon} Precision is low. Consider tuning your model to reduce false positives.`);
			}

			if (metrics.recall >= 0.9) {
				recommendations.push(`${goodIcon} Recall is good, capturing most positive instances.`);
			} else if (metrics.recall >= 0.75) {
				recommendations.push(`${moderateIcon} Recall is moderate. Some positive instances are missed.`);
			} else {
				recommendations.push(`${badIcon} Recall is low. Consider reviewing why positive instances are being missed.`);
			}

			if (metrics.specificity >= 0.9) {
				recommendations.push(`${goodIcon} Specificity is good, effectively identifying negative instances.`);
			} else if (metrics.specificity >= 0.75) {
				recommendations.push(`${moderateIcon} Specificity is moderate. There might be some false negatives.`);
			} else {
				recommendations.push(`${badIcon} Specificity is low. Consider investigating the causes of false negatives.`);
			}

			if (metrics.npv >= 0.9) {
				recommendations.push(`${goodIcon} NPV is good, indicating reliable negative predictions.`);
			} else if (metrics.npv >= 0.75) {
				recommendations.push(`${moderateIcon} NPV is moderate. There may be some inaccuracies in negative predictions.`);
			} else {
				recommendations.push(`${badIcon} NPV is low. Consider why negative predictions might be unreliable.`);
			}

			if (metrics.f1_score >= 0.9) {
				recommendations.push(`${goodIcon} F1 Score is good, balancing precision and recall well.`);
			} else if (metrics.f1_score >= 0.75) {
				recommendations.push(`${moderateIcon} F1 Score is moderate. There might be a trade-off between precision and recall.`);
			} else {
				recommendations.push(`${badIcon} F1 Score is low. Investigate the balance between precision and recall.`);
			}

			return recommendations;
		}

        /* Update metric results and apply color coding based on value */
        function updateMetricResults(metrics) {
			const metricElements = {
				f1_score: document.getElementById('f1-result'),
				accuracy: document.getElementById('accuracy-result'),
				precision: document.getElementById('precision-result'),
				npv: document.getElementById('npv-result'),
				recall: document.getElementById('recall-result'),
				specificity: document.getElementById('specificity-result')
			};

			for (const metric in metrics) {
				const value = parseFloat(metrics[metric]);
				let className = '';

				if (value >= 0.9) {
					className = 'metric-value-green';
				} else if (value >= 0.75 && value < 0.9) {
					className = 'metric-value-amber';
				} else {
					className = 'metric-value-red';
				}

				metricElements[metric].innerText = metrics[metric];
				metricElements[metric].className = className;
			}

			const overallSummary = generateOverallSummary(metrics);
			const recommendations = generateRecommendations(metrics);

			const summaryIconColor = '#007BFF';
			
			document.getElementById('overallSummary').innerHTML = '<div class="insight"><span class="insight-icon"><i class="fas fa-scroll" style="color: ' + summaryIconColor + '; margin-right: 8px;"></i></span>' + overallSummary + '</div>';
			document.getElementById('recommendations').innerHTML = recommendations.map(rec => '<div class="insight">' + rec + '</div>').join('');
		}

        /* Update the metrics chart with new data */
		function updateChart(data) {
            const isDarkMode = document.body.classList.contains('dark-mode');
            const textColor = getComputedStyle(document.documentElement).getPropertyValue(isDarkMode ? '--dark-mode-text-color' : '--text-color').trim();

            const backgroundColors = data.map(value => {
                if (value >= 0.9) {
                    return 'rgba(75, 192, 192, 0.7)';
                } else if (value >= 0.75 && value < 0.9) {
                    return 'rgba(255, 206, 86, 0.7)';
                } else {
                    return 'rgba(255, 99, 132, 0.7)';
                }
            });

            const borderColors = backgroundColors.map(color => color.replace('0.7', '1'));

            const ctx = document.getElementById('metricsChart').getContext('2d');
            if (myChart) {
                myChart.destroy();
                myChart = null;
            }

            myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Accuracy', 'Precision', 'Recall', 'Specificity', 'NPV', 'F1 Score'],
                    datasets: [{
                        label: 'Metrics',
                        data: data,
                        backgroundColor: backgroundColors,
                        borderColor: borderColors,
                        borderWidth: 1,
                        barThickness: 40
                    }]
                },
                options: {
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: textColor,
                                font: {
                                    family: "'Roboto', sans-serif",
                                    size: 14
                                }
                            },
                        },
                        y: {
                            grid: {
                                display: false
                            },
                            beginAtZero: true,
                            ticks: {
                                color: textColor,
                                font: {
                                    family: "'Roboto', sans-serif",
                                    size: 14
                                }
                            },
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        /* Initialize dark mode toggle functionality */
		function initializeDarkModeToggle() {
            const toggleContainer = document.getElementById('dark-mode-toggle');
            toggleContainer.addEventListener('click', toggleDarkMode);

            if (document.body.classList.contains('dark-mode')) {
                toggleContainer.classList.add('active');
            } else {
                toggleContainer.classList.remove('active');
            }
        }

        /* Toggle between light and dark modes */
		function toggleDarkMode() {
            const body = document.body;
            const toggleContainer = document.getElementById('dark-mode-toggle');
            const isDarkMode = body.classList.toggle('dark-mode');

            toggleContainer.classList.toggle('active', isDarkMode);

            calculateMetrics();

            const tooltips = document.querySelectorAll('.tooltip .tooltiptext');
            tooltips.forEach(tooltip => {
                if (isDarkMode) {
                    tooltip.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue('--dark-mode-input-bg-color').trim();
                    tooltip.style.color = getComputedStyle(document.documentElement).getPropertyValue('--dark-mode-text-color').trim();
                } else {
                    tooltip.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue('--tooltip-bg-color').trim();
                    tooltip.style.color = '#fff';
                }
            });
        }
    </script>
</body>
</html>